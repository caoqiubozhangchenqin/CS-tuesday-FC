# 📱 超简单上传小说指南

## 我为您创建了一个可视化上传页面！

不用写代码，只需要填表单就能上传小说了。

---

## 🚀 使用步骤（5分钟完成）

### 第 1 步：打开上传页面
在微信开发者工具的调试器控制台输入：
```javascript
wx.navigateTo({
  url: '/pages/admin/upload-novel/upload-novel'
})
```

或者在小程序任意页面的 wxml 中添加一个按钮：
```xml
<button bindtap="goToUpload">上传小说</button>
```

对应的 js 中添加：
```javascript
goToUpload() {
  wx.navigateTo({
    url: '/pages/admin/upload-novel/upload-novel'
  })
}
```

### 第 2 步：填写表单
页面会显示一个漂亮的表单，按照提示填写：

1. **小说标题**（必填）
   - 例如：《三体》

2. **作者**（必填）
   - 例如：刘慈欣

3. **分类**（选填，默认"小说"）
   - 可选：小说、玄幻、言情、悬疑、科幻、历史、其他

4. **标签**（选填）
   - 例如：科幻,硬核,获奖作品
   - 用逗号分隔多个标签

5. **简介**（选填）
   - 例如：地球往事三部曲之一，讲述了地球人类文明和三体文明的信息交流...

6. **选择 TXT 文件**（必填）
   - 点击"选择 TXT 文件"按钮
   - 从手机或电脑选择一个 .txt 文件

### 第 3 步：点击上传
- 点击底部的"开始上传"按钮
- 等待进度提示
- 看到"上传成功"弹窗就完成了！

---

## 📸 页面预览

页面长这样：

```
┌─────────────────────────┐
│      📚 上传小说          │
│       管理员专用          │
├─────────────────────────┤
│                         │
│  小说标题 *              │
│  [输入框]               │
│                         │
│  作者 *                 │
│  [输入框]               │
│                         │
│  分类                   │
│  [小说 ▼]               │
│                         │
│  标签                   │
│  [输入框]               │
│                         │
│  简介                   │
│  [文本框]               │
│                         │
│  小说文件 *              │
│  [选择 TXT 文件]         │
│                         │
│  ┌───────────────────┐  │
│  │   开始上传        │  │
│  └───────────────────┘  │
│                         │
│  💡 使用提示：           │
│  1. 仅支持 TXT 格式文件  │
│  2. 标题和作者为必填项   │
│  3. 标签用逗号分隔       │
│  4. 上传后可在书城查看   │
└─────────────────────────┘
```

---

## ✅ 上传成功后会显示

```
上传成功！

《三体》已成功上传
总字数: 450,000
总页数: 900

[确定]
```

---

## 🎯 快速测试（1分钟）

1. **在调试器控制台输入：**
   ```javascript
   wx.navigateTo({ url: '/pages/admin/upload-novel/upload-novel' })
   ```

2. **填写测试信息：**
   - 标题：测试小说
   - 作者：测试作者
   - 选择任意 TXT 文件

3. **点击上传**

4. **查看结果：**
   ```javascript
   wx.navigateTo({ url: '/pages/novel/bookstore/bookstore' })
   ```

---

## 🔧 如果遇到问题

### 问题1：提示"权限不足"
**原因**：您的 openid 未配置为管理员  
**解决**：确认 `cloudfunctions/adminUploadNovel/index.js` 第27行包含您的 openid：
```javascript
const ADMIN_LIST = ['oVAxOvrDAY9Q0qG8WBnRxO3_m1nw']
```

### 问题2：提示"novels 集合不存在"
**原因**：数据库集合未创建  
**解决**：在云开发后台创建 `novels` 集合，权限设为"所有用户可读"

### 问题3：选择文件失败
**原因**：微信小程序在某些环境下可能无法选择文件  
**解决**：
- 在真机上测试（而非模拟器）
- 或使用云存储直接上传（见文档"不再需要解析书籍-新系统使用指南.md"）

---

## 📚 相关文档

- `不再需要解析书籍-新系统使用指南.md` - 了解新系统原理
- `公共小说系统部署指南.md` - 完整部署流程
- `数据库集合配置指南.md` - 数据库配置详解

---

## 💡 提示

- ✅ 这个页面**只有管理员能用**（已通过 openid 验证）
- ✅ 上传的小说会**自动计算页数**（每页500字）
- ✅ 所有用户都能在**书城看到**您上传的小说
- ✅ 支持**任意大小**的 TXT 文件

现在就试试吧！🎉
