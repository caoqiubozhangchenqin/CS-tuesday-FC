<!-- pages/world_football/world_football.wxml -->
<bg src="{{bgImageUrl}}" overlayOpacity="0.5" blur="0" sizeMode="cover" repeat="false" />

<view class="container main-container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title">ğŸŒ äº”å¤§è”èµ›å†å²æ•°æ®</text>
  </view>

  <!-- è”èµ›é€‰æ‹©æ ‡ç­¾ -->
  <view class="league-tabs">
    <block wx:for="{{leagues}}" wx:key="id">
      <view 
        class="league-tab {{currentLeague === item.id ? 'active' : ''}}" 
        bindtap="switchLeague" 
        data-league="{{item.id}}"
        data-name="{{item.name}}">
        <text class="league-name">{{item.name}}</text>
      </view>
    </block>
  </view>

  <!-- èµ›å­£é€‰æ‹©å™¨ - æ”¹ä¸ºä¸‹æ‹‰é€‰æ‹© -->
  <view class="season-selector">
    <view class="season-label">é€‰æ‹©èµ›å­£ï¼š</view>
    <picker class="season-picker" mode="selector" range="{{seasons}}" range-key="name" value="{{seasonIndex}}" bindchange="onSeasonChange">
      <view class="picker-value">
        {{seasons[seasonIndex].name}}
        <text class="picker-arrow">â–¼</text>
      </view>
    </picker>
  </view>

  <!-- èµ›å­£ä¿¡æ¯ -->
  <view wx:if="{{seasonInfo && !loading && !error}}" class="season-info-bar">
    <text class="season-title">ğŸ“Š {{seasonInfo}}</text>
    <text wx:if="{{standings.length > 0}}" class="champion-info">ğŸ† å† å†›: {{standings[0].team}}</text>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- é”™è¯¯æç¤º -->
  <view wx:if="{{error}}" class="error-container">
    <text class="error-icon">âš ï¸</text>
    <text class="error-text">{{error}}</text>
    <button class="retry-btn" bindtap="loadLeagueData">é‡è¯•</button>
  </view>

  <!-- ç§¯åˆ†æ¦œå±•ç¤º -->
  <view wx:if="{{!loading && !error && standings.length > 0}}" class="standings-container">
    <!-- ç§¯åˆ†æ¦œè¡¨å¤´ -->
    <view class="standings-header">
      <text class="col-rank">æ’å</text>
      <text class="col-team">çƒé˜Ÿ</text>
      <text class="col-stat">èµ›</text>
      <text class="col-stat">èƒœ</text>
      <text class="col-stat">å¹³</text>
      <text class="col-stat">è´Ÿ</text>
      <text class="col-stat">è¿›</text>
      <text class="col-stat">å¤±</text>
      <text class="col-stat">å‡€</text>
      <text class="col-pts">ç§¯åˆ†</text>
    </view>

    <!-- ç§¯åˆ†æ¦œæ•°æ® -->
    <view class="standings-list">
      <block wx:for="{{standings}}" wx:key="team">
        <view class="standing-item {{index < 4 ? 'champions-league' : index < 6 ? 'europa-league' : index >= standings.length - 3 ? 'relegation' : ''}}">
          <text class="col-rank rank-badge">{{index + 1}}</text>
          <text class="col-team team-name">{{item.team}}</text>
          <text class="col-stat">{{item.played}}</text>
          <text class="col-stat stat-won">{{item.won}}</text>
          <text class="col-stat stat-draw">{{item.draw}}</text>
          <text class="col-stat stat-lost">{{item.lost}}</text>
          <text class="col-stat">{{item.gf}}</text>
          <text class="col-stat">{{item.ga}}</text>
          <text class="col-stat {{item.gd > 0 ? 'positive' : item.gd < 0 ? 'negative' : ''}}">{{item.gd > 0 ? '+' : ''}}{{item.gd}}</text>
          <text class="col-pts points-badge">{{item.pts}}</text>
        </view>
      </block>
    </view>

    <!-- å›¾ä¾‹ -->
    <view class="legend">
      <view class="legend-item">
        <view class="legend-color champions-league-color"></view>
        <text>æ¬§å† åŒº</text>
      </view>
      <view class="legend-item">
        <view class="legend-color europa-league-color"></view>
        <text>æ¬§è”åŒº</text>
      </view>
      <view class="legend-item">
        <view class="legend-color relegation-color"></view>
        <text>é™çº§åŒº</text>
      </view>
    </view>
  </view>

  <!-- æ•°æ®æ¥æºè¯´æ˜ -->
  <view class="footer-info">
    <text class="info-text">æ•°æ®æ¥æºï¼šOpenFootball.json</text>
    <text class="info-text">å†å²èµ›å­£ç§¯åˆ†æ¦œæŸ¥è¯¢</text>
  </view>
</view>
