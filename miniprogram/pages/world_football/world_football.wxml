<!-- pages/world_football/world_football.wxml -->
<bg src="{{bgImageUrl}}" overlayOpacity="0.5" blur="0" sizeMode="cover" repeat="false" />

<view class="container main-container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title">ğŸŒ ä¸–ç•Œè¶³çƒ</text>
    <text class="page-subtitle">äº”å¤§è”èµ›æ•°æ®ä¸­å¿ƒ</text>
  </view>

  <!-- è”èµ›é€‰æ‹©æ ‡ç­¾ -->
  <view class="league-tabs">
    <block wx:for="{{leagues}}" wx:key="id">
      <view 
        class="league-tab {{currentLeague === item.id ? 'active' : ''}}" 
        bindtap="switchLeague" 
        data-league="{{item.id}}"
        data-name="{{item.name}}">
        <text class="league-name">{{item.name}}</text>
      </view>
    </block>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- é”™è¯¯æç¤º -->
  <view wx:if="{{error}}" class="error-container">
    <text class="error-icon">âš ï¸</text>
    <text class="error-text">{{error}}</text>
    <button class="retry-btn" bindtap="loadLeagueData">é‡è¯•</button>
  </view>

  <!-- æ•°æ®å±•ç¤ºåŒº -->
  <view wx:if="{{!loading && !error}}" class="content-area">
    <!-- åŠŸèƒ½æ ‡ç­¾é¡µ -->
    <view class="function-tabs">
      <view 
        class="function-tab {{activeTab === 'standings' ? 'active' : ''}}" 
        bindtap="switchTab" 
        data-tab="standings">
        <text>ğŸ† ç§¯åˆ†æ¦œ</text>
      </view>
      <view 
        class="function-tab {{activeTab === 'matches' ? 'active' : ''}}" 
        bindtap="switchTab" 
        data-tab="matches">
        <text>âš½ æœ€è¿‘èµ›æœ</text>
      </view>
      <view 
        class="function-tab {{activeTab === 'upcoming' ? 'active' : ''}}" 
        bindtap="switchTab" 
        data-tab="upcoming">
        <text>ğŸ“… å³å°†å¼€èµ›</text>
      </view>
    </view>

    <!-- ç§¯åˆ†æ¦œ -->
    <view wx:if="{{activeTab === 'standings'}}" class="standings-container">
      <view class="section-title">{{leagueName}} 2024-25 èµ›å­£ç§¯åˆ†æ¦œ</view>
      
      <view wx:if="{{standings.length === 0}}" class="empty-state">
        <text class="empty-icon">ğŸ†</text>
        <text class="empty-text">æš‚æ— ç§¯åˆ†æ¦œæ•°æ®</text>
      </view>

      <!-- ç§¯åˆ†æ¦œè¡¨å¤´ -->
      <view wx:if="{{standings.length > 0}}" class="standings-header">
        <text class="col-rank">æ’å</text>
        <text class="col-team">çƒé˜Ÿ</text>
        <text class="col-stat">èµ›</text>
        <text class="col-stat">èƒœ</text>
        <text class="col-stat">å¹³</text>
        <text class="col-stat">è´Ÿ</text>
        <text class="col-stat">è¿›</text>
        <text class="col-stat">å¤±</text>
        <text class="col-stat">å‡€</text>
        <text class="col-pts">ç§¯åˆ†</text>
      </view>

      <!-- ç§¯åˆ†æ¦œæ•°æ® -->
      <view class="standings-list">
        <block wx:for="{{standings}}" wx:key="team">
          <view class="standing-item {{index < 4 ? 'champions-league' : index < 6 ? 'europa-league' : index >= standings.length - 3 ? 'relegation' : ''}}">
            <text class="col-rank rank-badge">{{index + 1}}</text>
            <text class="col-team team-name">{{item.team}}</text>
            <text class="col-stat">{{item.played}}</text>
            <text class="col-stat stat-won">{{item.won}}</text>
            <text class="col-stat stat-draw">{{item.draw}}</text>
            <text class="col-stat stat-lost">{{item.lost}}</text>
            <text class="col-stat">{{item.gf}}</text>
            <text class="col-stat">{{item.ga}}</text>
            <text class="col-stat {{item.gd > 0 ? 'positive' : item.gd < 0 ? 'negative' : ''}}">{{item.gd > 0 ? '+' : ''}}{{item.gd}}</text>
            <text class="col-pts points-badge">{{item.pts}}</text>
          </view>
        </block>
      </view>

      <!-- å›¾ä¾‹ -->
      <view class="legend">
        <view class="legend-item">
          <view class="legend-color champions-league-color"></view>
          <text>æ¬§å† åŒº</text>
        </view>
        <view class="legend-item">
          <view class="legend-color europa-league-color"></view>
          <text>æ¬§è”åŒº</text>
        </view>
        <view class="legend-item">
          <view class="legend-color relegation-color"></view>
          <text>é™çº§åŒº</text>
        </view>
      </view>
    </view>

    <!-- æœ€è¿‘èµ›æœ -->
    <view wx:if="{{activeTab === 'matches'}}" class="matches-container">
      <view class="section-title">æœ€è¿‘20åœºæ¯”èµ›</view>
      
      <view wx:if="{{recentMatches.length === 0}}" class="empty-state">
        <text class="empty-icon">âš½</text>
        <text class="empty-text">æš‚æ— æ¯”èµ›è®°å½•</text>
      </view>

      <view class="matches-list">
        <block wx:for="{{recentMatches}}" wx:key="index">
          <view class="match-item">
            <view class="match-header">
              <text class="match-round">{{item.round}}</text>
              <text class="match-date">{{item.date}}</text>
            </view>
            <view class="match-body">
              <view class="match-team home-team">
                <text class="team-name">{{item.team1}}</text>
              </view>
              <view class="match-score">
                <text class="score-num">{{item.score.ft[0]}}</text>
                <text class="score-separator">-</text>
                <text class="score-num">{{item.score.ft[1]}}</text>
              </view>
              <view class="match-team away-team">
                <text class="team-name">{{item.team2}}</text>
              </view>
            </view>
          </view>
        </block>
      </view>
    </view>

    <!-- å³å°†å¼€èµ› -->
    <view wx:if="{{activeTab === 'upcoming'}}" class="upcoming-container">
      <view class="section-title">æœªæ¥20åœºæ¯”èµ›</view>
      
      <view wx:if="{{upcomingMatches.length === 0}}" class="empty-state">
        <text class="empty-icon">ğŸ“…</text>
        <text class="empty-text">æš‚æ— å³å°†è¿›è¡Œçš„æ¯”èµ›</text>
      </view>

      <view class="matches-list">
        <block wx:for="{{upcomingMatches}}" wx:key="index">
          <view class="match-item upcoming-item">
            <view class="match-header">
              <text class="match-round">{{item.round}}</text>
              <text class="match-date">{{item.date}}</text>
            </view>
            <view class="match-body">
              <view class="match-team home-team">
                <text class="team-name">{{item.team1}}</text>
              </view>
              <view class="vs-badge">
                <text class="vs-text">VS</text>
              </view>
              <view class="match-team away-team">
                <text class="team-name">{{item.team2}}</text>
              </view>
            </view>
          </view>
        </block>
      </view>
    </view>
  </view>

  <!-- æ•°æ®æ¥æºè¯´æ˜ -->
  <view class="footer-info">
    <text class="info-text">æ•°æ®æ¥æºï¼šOpenFootball</text>
    <text class="info-text">æ¯å‘¨è‡ªåŠ¨æ›´æ–°</text>
  </view>
</view>
