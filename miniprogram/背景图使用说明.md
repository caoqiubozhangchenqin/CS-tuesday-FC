# 全局背景图使用说明

## 已完成的配置

1. ✅ **app.js** - 已添加云存储背景图获取逻辑和 `setPageBackground()` 方法
2. ✅ **app.wxss** - 已添加 `.page-background` 样式类
3. ✅ **index 页面** - 已作为示例完成配置（包含文字颜色优化）

## ✅ 已完成背景图的页面

- index（首页）- 已完成并优化

## 📋 待添加背景图的页面列表

以下页面需要手动添加背景图支持：
- admin（管理员页面）
- captain_panel（队长面板）
- ranking（身价排行榜）
- registration_status（报名状态）
- result（结果页面）
- schedule（赛程页面）
- standings（积分榜）
- survey（评估问卷）
- team_signup（队伍报名）
- team_status（队伍状态）

## 如何为其他页面添加背景图

### 方法一：手动添加（推荐，更灵活）

对于每个需要背景的页面，按以下步骤操作：

#### 步骤1：修改页面的 `.js` 文件

在 `data` 中添加：
```javascript
data: {
  // ... 其他数据
  globalBgUrl: ''  // 添加这一行
},
```

在 `onLoad` 函数的**最开始**添加：
```javascript
onLoad: function() {
  // 设置全局背景图
  getApp().setPageBackground(this);
  
  // ... 其他代码
},
```

#### 步骤2：修改页面的 `.wxml` 文件

在文件的**最顶部**（第一个元素之前）添加：
```xml
<!-- 全局背景图 -->
<view class="page-background" style="background-image: url({{globalBgUrl}});"></view>
```

### 方法二：使用混入（适合批量处理）

如果你想批量处理多个页面，可以使用已创建的混入文件：

1. 在页面 JS 文件顶部引入：
```javascript
const pageBackgroundMixin = require('../../utils/page-background-mixin.js');
```

2. 将原来的 `Page({...})` 改为：
```javascript
Page(pageBackgroundMixin({
  // 原来的页面配置
}));
```

3. 仍然需要在 wxml 中添加背景容器（同方法一的步骤2）

## 示例页面

参考 `pages/index/` 目录下的文件，已经完整实现了背景图功能。

## 背景图说明

- 背景图文件：`cloud://cloud1-3ge5gomsffe800a7.636c-cloud1-3ge5gomsffe800a7-1373366709/足球.jpg`
- 加载方式：小程序启动时自动从云存储获取临时URL
- 样式效果：cover（覆盖）、center（居中）、fixed（固定）
- 不会增加小程序包体积（使用云存储）

## 注意事项

1. 云存储临时URL有效期约为2小时，小程序会在启动时自动刷新
2. 背景图层级为 `z-index: -1`，不会遮挡页面内容
3. 如果某个页面不需要背景，直接不添加即可
4. 建议为页面内容区域添加半透明背景，提高可读性

## 快速批量添加脚本

如果需要为所有页面批量添加，可以运行以下命令（需要 Node.js）：

```bash
# 待开发：批量添加脚本
node scripts/add-background-to-all-pages.js
```
