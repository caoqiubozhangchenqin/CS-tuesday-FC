# ğŸ“š ä¹¦æ¶æ˜¾ç¤ºé—®é¢˜ä¿®å¤æŒ‡å—

## é—®é¢˜è¯Šæ–­

æ‚¨ä¸Šä¼ çš„ã€Šä¸­åœºä¸»å®°-æƒŠè‰³ä¸€è„šã€‹åœ¨ä¹¦æ¶ä¸­æ²¡æœ‰æ­£ç¡®æ˜¾ç¤ºã€‚

å¯èƒ½çš„åŸå› ï¼š
1. æ•°æ®åº“å­—æ®µåä¸åŒ¹é…ï¼ˆæ–°ç³»ç»Ÿç”¨ `title`ï¼Œæ—§ç³»ç»Ÿç”¨ `name`ï¼‰
2. ä¹¦æ¶é¡µé¢ç¼“å­˜æœªåˆ·æ–°
3. æ•°æ®åº“é›†åˆ `novels` ä¸å­˜åœ¨æˆ–æƒé™é—®é¢˜

---

## âœ… å·²ä¿®å¤çš„å†…å®¹

### 1. æ›´æ–°äº†ä¹¦æ¶é¡µé¢ä»£ç 

**ä¿®æ”¹æ–‡ä»¶ï¼š** `miniprogram/pages/novel/shelf/shelf.js`

**å…¼å®¹æ–°æ—§å­—æ®µï¼š**
```javascript
name: book.title || book.name || 'æœªå‘½å'  // æ–°ä¼˜å…ˆï¼Œæ—§å¤‡ç”¨
intro: book.description || book.intro || 'æš‚æ— ç®€ä»‹'
size: book.fileSize || book.size || 0
```

**æ–°å¢åŠŸèƒ½ï¼š**
- âœ… æ˜¾ç¤ºæ€»é¡µæ•°å’Œå­—æ•°
- âœ… è‡ªåŠ¨æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
- âœ… å…¼å®¹æ–°æ—§æ•°æ®åº“ç»“æ„

---

## ğŸ” ç«‹å³è¯Šæ–­

### ç¬¬ 1 æ­¥ï¼šè¿è¡Œæ£€æŸ¥è„šæœ¬

åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·è°ƒè¯•å™¨æ§åˆ¶å°è¿è¡Œï¼š

```javascript
// å¤åˆ¶ check-shelf-data.js ä¸­çš„å†…å®¹
// æˆ–ç›´æ¥è¿è¡Œï¼š

wx.cloud.database().collection('novels')
  .orderBy('uploadTime', 'desc')
  .get()
  .then(res => {
    console.log('æ•°æ®åº“ä¸­çš„ä¹¦ç±:', res.data.length, 'æœ¬')
    if (res.data.length > 0) {
      console.log('ç¬¬ä¸€æœ¬ä¹¦:', res.data[0].title || res.data[0].name)
      console.log('å®Œæ•´æ•°æ®:', res.data[0])
    }
  })
```

**æœŸæœ›çœ‹åˆ°ï¼š**
```
æ•°æ®åº“ä¸­çš„ä¹¦ç±: 1 æœ¬
ç¬¬ä¸€æœ¬ä¹¦: ä¸­åœºä¸»å®°-æƒŠè‰³ä¸€è„š
```

---

### ç¬¬ 2 æ­¥ï¼šåˆ·æ–°ä¹¦æ¶é¡µé¢

1. **åœ¨ä¹¦æ¶é¡µé¢ï¼Œä¸‹æ‹‰åˆ·æ–°**
2. æˆ–è€…**å…³é—­ä¹¦æ¶é¡µé¢ï¼Œé‡æ–°æ‰“å¼€**
3. æˆ–è€…**é‡æ–°ç¼–è¯‘å°ç¨‹åº**ï¼ˆCtrl+Bï¼‰

---

### ç¬¬ 3 æ­¥ï¼šæ£€æŸ¥æ•°æ®åº“æƒé™

åœ¨äº‘å¼€å‘æ§åˆ¶å°ï¼š

1. è¿›å…¥ **æ•°æ®åº“** â†’ **novels** é›†åˆ
2. æ£€æŸ¥ **æƒé™è®¾ç½®**ï¼š
   ```json
   {
     "read": true,
     "write": false
   }
   ```
   - `read: true` â†’ æ‰€æœ‰ç”¨æˆ·å¯è¯»
   - `write: false` â†’ é˜²æ­¢æ™®é€šç”¨æˆ·ä¿®æ”¹

3. å¦‚æœæƒé™ä¸å¯¹ï¼Œç‚¹å‡» **"ä¿®æ”¹æƒé™"** è°ƒæ•´

---

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼šæ•°æ®åº“ä¸­æœ‰æ•°æ®ï¼Œä½†ä¹¦æ¶ä¸æ˜¾ç¤º

**åŸå› ï¼š** å­—æ®µåä¸åŒ¹é…  
**è§£å†³ï¼š** 
1. å·²åœ¨ä»£ç ä¸­å…¼å®¹ï¼ˆ`title || name`ï¼‰
2. é‡æ–°ç¼–è¯‘å°ç¨‹åºï¼ˆCtrl+Bï¼‰
3. åˆ·æ–°ä¹¦æ¶é¡µé¢

### é—®é¢˜ 2ï¼šæç¤º"æ•°æ®åº“é›†åˆä¸å­˜åœ¨"

**åŸå› ï¼š** `novels` é›†åˆæœªåˆ›å»º  
**è§£å†³ï¼š**
1. äº‘å¼€å‘æ§åˆ¶å° â†’ æ•°æ®åº“
2. ç‚¹å‡» **"æ·»åŠ é›†åˆ"**
3. é›†åˆåï¼š`novels`
4. æƒé™ï¼šæ‰€æœ‰ç”¨æˆ·å¯è¯»

### é—®é¢˜ 3ï¼šä¹¦æ¶ä¸€ç›´æ˜¾ç¤º"åŠ è½½ä¸­"

**åŸå› ï¼š** æ•°æ®åº“æŸ¥è¯¢å¤±è´¥  
**è§£å†³ï¼š**
1. æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯æ—¥å¿—
2. æ£€æŸ¥äº‘å¼€å‘ç¯å¢ƒæ˜¯å¦å¼€é€š
3. æ£€æŸ¥æ•°æ®åº“æƒé™

### é—®é¢˜ 4ï¼šæ˜¾ç¤º"ä¹¦æ¶ç©ºç©ºå¦‚ä¹Ÿ"

**åŸå› ï¼š** æ•°æ®åº“æŸ¥è¯¢è¿”å›ç©ºæ•°ç»„  
**è§£å†³ï¼š**
1. è¿è¡Œè¯Šæ–­è„šæœ¬æ£€æŸ¥æ•°æ®åº“
2. é‡æ–°ä¸Šä¼ ä¹¦ç±
3. æ£€æŸ¥ `uploadTime` å­—æ®µæ˜¯å¦å­˜åœ¨

---

## ğŸ“Š æ•°æ®åº“å­—æ®µå¯¹ç…§è¡¨

| å­—æ®µ | æ—§ç³»ç»Ÿ | æ–°ç³»ç»Ÿ | ä¹¦æ¶æ˜¾ç¤º |
|------|--------|--------|----------|
| ä¹¦å | `name` | `title` | âœ… å…¼å®¹ |
| ç®€ä»‹ | `intro` | `description` | âœ… å…¼å®¹ |
| æ–‡ä»¶å¤§å° | `size` | `fileSize` | âœ… å…¼å®¹ |
| æ–‡ä»¶è·¯å¾„ | `cloudPath` | - | âœ… å¯é€‰ |
| æ€»é¡µæ•° | - | `totalPages` | âœ… æ–°å¢ |
| æ€»å­—æ•° | - | `totalChars` | âœ… æ–°å¢ |

---

## ğŸ¯ å¿«é€Ÿæµ‹è¯•æµç¨‹

### 1. æ£€æŸ¥æ•°æ®åº“
```javascript
wx.cloud.database().collection('novels').count()
  .then(res => console.log('ä¹¦ç±æ€»æ•°:', res.total))
```

### 2. åˆ·æ–°ä¹¦æ¶
```javascript
// åœ¨ä¹¦æ¶é¡µé¢æ§åˆ¶å°è¿è¡Œ
getCurrentPages()[getCurrentPages().length - 1].loadCloudBooks()
```

### 3. æŸ¥çœ‹ä¹¦æ¶æ•°æ®
```javascript
const page = getCurrentPages()[getCurrentPages().length - 1]
console.log('ä¹¦æ¶æ•°æ®:', page.data.bookList)
```

---

## ğŸ’¡ å¦‚æœä»ç„¶ä¸æ˜¾ç¤º

### ç»ˆæè§£å†³æ–¹æ¡ˆï¼š

1. **æŸ¥çœ‹åŸå§‹æ•°æ®åº“æ•°æ®ï¼š**
   ```javascript
   wx.cloud.database().collection('novels')
     .get()
     .then(res => console.log('åŸå§‹æ•°æ®:', JSON.stringify(res.data, null, 2)))
   ```

2. **æ‰‹åŠ¨è°ƒç”¨åŠ è½½å‡½æ•°ï¼š**
   ```javascript
   const pages = getCurrentPages()
   const shelfPage = pages[pages.length - 1]
   shelfPage.loadCloudBooks()
   ```

3. **æ¸…é™¤ç¼“å­˜é‡æ–°ç¼–è¯‘ï¼š**
   - å·¥å…·æ  â†’ æ¸…ç¼“å­˜ â†’ æ¸…é™¤æ‰€æœ‰ç¼“å­˜
   - Ctrl+B é‡æ–°ç¼–è¯‘

---

## ğŸ“ éœ€è¦æ›´å¤šå¸®åŠ©ï¼Ÿ

å¦‚æœä»¥ä¸Šæ–¹æ³•éƒ½ä¸è¡Œï¼Œè¯·æä¾›ï¼š

1. è¿è¡Œ `check-shelf-data.js` çš„å®Œæ•´è¾“å‡º
2. æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯
3. æ•°æ®åº“ `novels` é›†åˆçš„æˆªå›¾

æˆ‘ä¼šå¸®æ‚¨è¿›ä¸€æ­¥è¯Šæ–­ï¼ğŸ”§
