# æ•°æ®åº“é›†åˆé…ç½®æŒ‡å—

## ğŸ“‹ éœ€è¦åˆ›å»ºçš„é›†åˆ

### 1. novelsï¼ˆå…¬å…±å°è¯´åº“ï¼‰

**åˆ›å»ºæ­¥éª¤**ï¼š
1. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…· â†’ äº‘å¼€å‘ â†’ æ•°æ®åº“
2. ç‚¹å‡»ã€Œæ·»åŠ é›†åˆã€
3. é›†åˆåç§°ï¼š`novels`
4. ç‚¹å‡»ã€Œæƒé™è®¾ç½®ã€æ ‡ç­¾
5. é€‰æ‹©è‡ªå®šä¹‰æƒé™ï¼Œè¾“å…¥ä»¥ä¸‹é…ç½®ï¼š

**æƒé™é…ç½®**ï¼š
```json
{
  "read": true,
  "write": false
}
```

**è¯´æ˜**ï¼š
- âœ… æ‰€æœ‰ç”¨æˆ·å¯è¯»ï¼ˆå…¬å…±å°è¯´åº“ï¼‰
- âŒ ä¸å…è®¸ç›´æ¥å†™å…¥ï¼ˆåªèƒ½é€šè¿‡äº‘å‡½æ•°ä¸Šä¼ ï¼‰

**ç´¢å¼•é…ç½®**ï¼ˆå¯é€‰ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½ï¼‰ï¼š
- å­—æ®µï¼š`status`ï¼Œç±»å‹ï¼šå‡åº
- å­—æ®µï¼š`category`ï¼Œç±»å‹ï¼šå‡åº
- å­—æ®µï¼š`viewCount`ï¼Œç±»å‹ï¼šé™åº
- å­—æ®µï¼š`uploadTime`ï¼Œç±»å‹ï¼šé™åº

---

### 2. reading_progressï¼ˆé˜…è¯»è¿›åº¦ï¼‰

**åˆ›å»ºæ­¥éª¤**ï¼š
1. äº‘å¼€å‘ â†’ æ•°æ®åº“ â†’ æ·»åŠ é›†åˆ
2. é›†åˆåç§°ï¼š`reading_progress`
3. æƒé™è®¾ç½®ï¼š

**æƒé™é…ç½®**ï¼š
```json
{
  "read": "doc._openid == auth.openid",
  "write": "doc._openid == auth.openid"
}
```

**è¯´æ˜**ï¼š
- âœ… ç”¨æˆ·åªèƒ½è¯»å†™è‡ªå·±çš„é˜…è¯»è¿›åº¦
- âœ… äº‘æ•°æ®åº“è‡ªåŠ¨å¤„ç† _openid è¿‡æ»¤

**ç´¢å¼•é…ç½®**ï¼š
- å­—æ®µï¼š`novelId`ï¼Œç±»å‹ï¼šå‡åº
- å­—æ®µï¼š`lastReadTime`ï¼Œç±»å‹ï¼šé™åº

---

### 3. user_shelfï¼ˆç”¨æˆ·ä¹¦æ¶ï¼‰

**åˆ›å»ºæ­¥éª¤**ï¼š
1. äº‘å¼€å‘ â†’ æ•°æ®åº“ â†’ æ·»åŠ é›†åˆ
2. é›†åˆåç§°ï¼š`user_shelf`
3. æƒé™è®¾ç½®ï¼š

**æƒé™é…ç½®**ï¼š
```json
{
  "read": "doc._openid == auth.openid",
  "write": "doc._openid == auth.openid"
}
```

**è¯´æ˜**ï¼š
- âœ… ç”¨æˆ·åªèƒ½ç®¡ç†è‡ªå·±çš„ä¹¦æ¶
- âœ… äº‘æ•°æ®åº“è‡ªåŠ¨è¿‡æ»¤ _openid

**ç´¢å¼•é…ç½®**ï¼š
- å­—æ®µï¼š`novelId`ï¼Œç±»å‹ï¼šå‡åº
- å­—æ®µï¼š`lastReadTime`ï¼Œç±»å‹ï¼šé™åº
- å­—æ®µï¼š`addTime`ï¼Œç±»å‹ï¼šé™åº

---

## ğŸ” éªŒè¯é›†åˆåˆ›å»ºæˆåŠŸ

### æ£€æŸ¥æ¸…å•
- [ ] `novels` é›†åˆå·²åˆ›å»ºï¼Œæƒé™ä¸º"æ‰€æœ‰ç”¨æˆ·å¯è¯»"
- [ ] `reading_progress` é›†åˆå·²åˆ›å»ºï¼Œæƒé™ä¸º"ä»…åˆ›å»ºè€…å¯è¯»å†™"
- [ ] `user_shelf` é›†åˆå·²åˆ›å»ºï¼Œæƒé™ä¸º"ä»…åˆ›å»ºè€…å¯è¯»å†™"

### æµ‹è¯•æ–¹æ³•

**æµ‹è¯• novels é›†åˆ**ï¼š
```javascript
// åœ¨å°ç¨‹åºä¸­æ‰§è¡Œ
const db = wx.cloud.database();
const res = await db.collection('novels').get();
console.log('novels é›†åˆæŸ¥è¯¢æˆåŠŸ:', res);
```

**æµ‹è¯• reading_progress é›†åˆ**ï¼š
```javascript
const res = await db.collection('reading_progress').get();
console.log('reading_progress é›†åˆæŸ¥è¯¢æˆåŠŸ:', res);
```

**æµ‹è¯• user_shelf é›†åˆ**ï¼š
```javascript
const res = await db.collection('user_shelf').get();
console.log('user_shelf é›†åˆæŸ¥è¯¢æˆåŠŸ:', res);
```

---

## ğŸ“ æ•°æ®ç»“æ„å‚è€ƒ

### novels é›†åˆç¤ºä¾‹æ•°æ®
```json
{
  "_id": "novel_xiyouji",
  "title": "è¥¿æ¸¸è®°",
  "author": "å´æ‰¿æ©",
  "cover": "cloud://env-id.xxx/covers/xiyouji.jpg",
  "category": "å¤å…¸åè‘—",
  "tags": ["ç¥è¯", "ç»å…¸", "å†’é™©"],
  "description": "ä¸­å›½å¤å…¸å››å¤§åè‘—ä¹‹ä¸€",
  
  "fileID": "cloud://env-id.xxx/novels/xiyouji.txt",
  "fileSize": 1024000,
  "totalChars": 500000,
  "totalPages": 1000,
  "charsPerPage": 500,
  
  "viewCount": 0,
  "favoriteCount": 0,
  
  "uploadTime": 1700654321000,
  "updateTime": 1700654321000,
  "status": "published",
  "isRecommended": false
}
```

### reading_progress é›†åˆç¤ºä¾‹æ•°æ®
```json
{
  "_id": "auto-generated",
  "_openid": "user-openid",
  
  "novelId": "novel_xiyouji",
  "novelTitle": "è¥¿æ¸¸è®°",
  
  "currentPage": 58,
  "charOffset": 29000,
  "totalPages": 1000,
  "progress": 5.8,
  
  "readingTime": 3600,
  "lastReadTime": 1700654321000,
  "updateTime": 1700654321000
}
```

### user_shelf é›†åˆç¤ºä¾‹æ•°æ®
```json
{
  "_id": "auto-generated",
  "_openid": "user-openid",
  
  "novelId": "novel_xiyouji",
  "novelTitle": "è¥¿æ¸¸è®°",
  "novelCover": "cloud://env-id.xxx/covers/xiyouji.jpg",
  "novelAuthor": "å´æ‰¿æ©",
  
  "addTime": 1700654321000,
  "lastReadTime": 1700654321000,
  "isFavorite": true
}
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: æƒé™é…ç½®åçœ‹ä¸åˆ°æ•ˆæœï¼Ÿ
**A**: éœ€è¦é‡æ–°ç¼–è¯‘å°ç¨‹åºï¼Œæ¸…é™¤ç¼“å­˜åå†æµ‹è¯•ã€‚

### Q2: å¦‚ä½•æ·»åŠ æµ‹è¯•æ•°æ®ï¼Ÿ
**A**: 
- `novels` é›†åˆï¼šåœ¨äº‘å¼€å‘æ§åˆ¶å°æ‰‹åŠ¨æ·»åŠ ï¼Œæˆ–ä½¿ç”¨äº‘å‡½æ•°ä¸Šä¼ 
- `reading_progress`ã€`user_shelf`ï¼šç”±å°ç¨‹åºè‡ªåŠ¨åˆ›å»ºï¼Œä¸éœ€è¦æ‰‹åŠ¨æ·»åŠ 

### Q3: å¦‚ä½•ä¿®æ”¹æƒé™ï¼Ÿ
**A**: 
1. äº‘å¼€å‘ â†’ æ•°æ®åº“ â†’ é€‰æ‹©é›†åˆ
2. ç‚¹å‡»ã€Œæƒé™è®¾ç½®ã€æ ‡ç­¾
3. ä¿®æ”¹ JSON é…ç½®
4. ç‚¹å‡»ã€Œä¿å­˜ã€

### Q4: ç´¢å¼•æ˜¯å¿…é¡»çš„å—ï¼Ÿ
**A**: ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ·»åŠ ç´¢å¼•å¯ä»¥æå‡æŸ¥è¯¢æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯å½“æ•°æ®é‡è¾ƒå¤§æ—¶ã€‚

---

## âœ… å®Œæˆæ ‡å¿—

é…ç½®å®Œæˆåï¼Œä½ åº”è¯¥çœ‹åˆ°ï¼š
- âœ… 3 ä¸ªé›†åˆå·²åˆ›å»º
- âœ… æƒé™é…ç½®æ­£ç¡®
- âœ… å¯ä»¥åœ¨å°ç¨‹åºä¸­æŸ¥è¯¢é›†åˆï¼ˆä¸æŠ¥é”™ï¼‰

---

**é…ç½®å®Œæˆå**ï¼Œè¯·ç»§ç»­ä¸‹ä¸€æ­¥ï¼šåˆ›å»ºç®¡ç†å‘˜ä¸Šä¼ äº‘å‡½æ•°ã€‚
